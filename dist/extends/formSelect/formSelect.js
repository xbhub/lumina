"use strict";function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(e,t,n){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=n():"function"==typeof define&&define.amd?define(n):t.layui&&e.define?e.define(["jquery"],function(t){e.link(e.setter.base+"lib/extend/formSelect/formSelect.css"),t("formSelect",n())}):t.formSelect=n()}("undefined"==typeof layui?null:layui,window,function(){function d(t){var o=this;this.config={name:null,max:null,maxTips:function(t,e,n,a){var c=M('[xid="'.concat(o.config.name,'"]')).prev().find(".".concat(f));(c=c.parents(".layui-form-item[pane]").length?c.parents(".layui-form-item[pane]"):c).attr("style","border-color: red !important"),setTimeout(function(){c.removeAttr("style")},300)},init:null,on:null,opened:null,closed:null,filter:function(t,e,n,a){return-1==n.name.indexOf(e)},clearid:-1,direction:"auto",height:null,isEmpty:!1,btns:[n[0],n[1],n[2]],searchType:0,create:function(t,e){return Date.now()},template:function(t,e){return e.name},showCount:0,isCreate:!1,placeholder:e,clearInput:!1},this.select=null,this.values=[],M.extend(this.config,t,{searchUrl:t.isSearch?t.searchUrl:null,placeholder:t.optionsFirst&&!t.optionsFirst.value&&t.optionsFirst.innerHTML||e,btns:t.radio?[n[1]]:[n[0],n[1],n[2]]},c[t.name]||a),(isNaN(this.config.showCount)||this.config.showCount<=0)&&(this.config.showCount=19921012)}function t(){this.appender(),this.on(),this.onreset()}var f="xm-select",p="xm-select-parent",u="xm-select-input",h="xm-select--suffix",v="xm-select-this",m="xm-select-label",y="xm-select-search",g="xm-select-search-type",x="xm-select-skin",k="xm-dis-disabled",b="xm-select-dis",C="xm-select-temp",w="xm-select-radio",S="xm-select-linkage",T="xm-select-dl",s="xm-select-hide",L="xm-hide-input",j="xm-select-sj",A="xm-select-title",E="xm-form-select",l="xm-form-selected",N="xm-select-none",D="xm-select-empty",H="xm-input",F="xm-dl-input",_="xm-select-tips",O="XM_PID_VALUE",I="xm-cz",i="xm-cz-group",e="请选择",P={},V={on:{},endOn:{},filter:{},maxTips:{},opened:{},closed:{}},U={type:"get",header:{},first:!0,data:{},searchUrl:"",searchName:"keyword",searchVal:null,keyName:"name",keyVal:"value",keySel:"selected",keyDis:"disabled",keyChildren:"children",dataType:"",delay:500,beforeSuccess:null,success:null,error:null,beforeSearch:null,response:{statusCode:0,statusName:"code",msgName:"msg",dataName:"data"},tree:{nextClick:function(t,e,n){n([])},folderChoose:!0,lazy:!0}},n=[{icon:"xm-iconfont icon-quanxuan",name:"全选",click:function(t,e){e.selectAll(t,!0,!0)}},{icon:"xm-iconfont icon-qingkong",name:"清空",click:function(t,e){e.removeAll(t,!0,!0)}},{icon:"xm-iconfont icon-fanxuan",name:"反选",click:function(t,e){e.reverse(t,!0,!0)}},{icon:"xm-iconfont icon-pifu",name:"换肤",click:function(t,e){e.skin(t)}}],M=window.$||window.layui&&window.layui.jquery,o=M(window),J={},a={},c={};t.prototype.appender=function(){Array.prototype.map||(Array.prototype.map=function(t,e){var n,a,c,o,i=Object(this),r=i.length>>>0;for(e&&(n=e),a=new Array(r),c=0;c<r;)c in i&&(o=i[c],o=t.call(n,o,c,i),a[c]=o),c++;return a}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){var n,a;if(null==this)throw new TypeError("this is null or not defined");var c,o=Object(this),i=o.length>>>0;if("function"!=typeof t)throw new TypeError(t+" is not a function");for(1<arguments.length&&(n=e),a=0;a<i;)a in o&&(c=o[a],t.call(n,c,a,o)),a++}),Array.prototype.filter||(Array.prototype.filter=function(t){if(null==this)throw new TypeError;var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var a,c=[],o=arguments[1],i=0;i<n;i++)i in e&&(a=e[i],t.call(o,a,i,e)&&c.push(a));return c})},t.prototype.init=function(t){var s=this;M(t||"select[".concat(f,"]")).each(function(t,e){var n=M(e),a=n.attr(f),c=n.next(".layui-form-select"),o=n.next(".".concat(p)),i={name:a,disabled:e.disabled,max:+n.attr("xm-select-max"),isSearch:null!=n.attr(y),searchUrl:n.attr(y),isCreate:null!=n.attr("xm-select-create"),radio:null!=n.attr(w),skin:n.attr(x),direction:n.attr("xm-select-direction"),optionsFirst:e.options[0],height:n.attr("xm-select-height"),formname:n.attr("name")||n.attr("_name"),layverify:n.attr("lay-verify")||n.attr("_lay-verify"),layverType:n.attr("lay-verType"),searchType:"dl"==n.attr(g)?1:0,showCount:+n.attr("xm-select-show-count")},r=n.find("option[selected]").toArray().map(function(t){return{name:t.innerHTML,value:t.value}}),l=new d(i);l.values=r,l.config.init?(l.values=l.config.init.map(function(t){return"object"==_typeof(t)?t:{name:n.find('option[value="'.concat(t,'"]')).text(),value:t}}).filter(function(t){return t.name}),l.config.init=l.values.concat([])):l.config.init=r.concat([]),l.values||(l.values=[]),P[a]=l,c[0]&&c.remove(),o[0]&&o.remove();c=s.renderSelect(a,l.config.placeholder,e),o=l.config.height&&"auto"!=l.config.height?'xm-hg style="height: 34px;"':"",e=['<div class="'.concat(m,'">'),'<input type="text" fsw class="'.concat(H," ").concat(u,'" ').concat(l.config.isSearch?"":'style="display: none;"',' autocomplete="off" debounce="0" />'),"</div>"],e=M('<div class="'.concat(E,'" ').concat(x,'="').concat(l.config.skin,'">\n\t\t\t\t\t<input class="').concat(L,'" value="" name="').concat(l.config.formname,'" lay-verify="').concat(l.config.layverify,'" lay-verType="').concat(l.config.layverType,'" type="text" style="position: absolute;bottom: 0; z-index: -1;width: 100%; height: 100%; border: none; opacity: 0;"/>\n\t\t\t\t\t<div class="').concat(A," ").concat(l.config.disabled?b:"",'">\n\t\t\t\t\t\t<div class="').concat(H," ").concat(f,'" ').concat(o,">\n\t\t\t\t\t\t\t").concat(e.join(""),'\n\t\t\t\t\t\t\t<i class="').concat(j,'"></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="').concat(h,'">\n\t\t\t\t\t\t\t<input type="text" autocomplete="off" placeholder="').concat(l.config.placeholder,'" readonly="readonly" unselectable="on" class="').concat(H,'">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<dl xid="').concat(a,'" class="').concat(T," ").concat(l.config.radio?w:"",'">').concat(c,"</dl>\n\t\t\t\t</div>")),c=M('<div class="'.concat(p,'" FS_ID="').concat(a,'"></div>'));c.append(e),n.after(c),n.attr("lay-ignore",""),n.removeAttr("name")&&n.attr("_name",l.config.formname),n.removeAttr("lay-verify")&&n.attr("_lay-verify",l.config.layverify),l.config.isSearch?(J[a]=M.extend({},U,{searchUrl:l.config.searchUrl},J[a]),M(document).on("input","div.".concat(p,'[FS_ID="').concat(a,'"] .').concat(u),function(t){s.search(a,t,l.config.searchUrl)}),l.config.searchUrl&&s.triggerSearch(e,!0)):e.find("dl dd.".concat(F)).css("display","none")})},t.prototype.search=function(a,t,e,n){var c=this;if(n)o=n;else{var o=t.target,i=t.keyCode;if(9===i||13===i||37===i||38===i||39===i||40===i)return!1}var r=M.trim(o.value);this.changePlaceHolder(M(o));n=J[a]||U;e=n.searchUrl||e;var t=P[a],i=t.config.isCreate,l=M('dl[xid="'.concat(a,'"]')).parents(".".concat(E));e?(n.searchVal&&(r=n.searchVal,n.searchVal=""),(!n.beforeSearch||n.beforeSearch&&n.beforeSearch instanceof Function&&n.beforeSearch(a,e,r))&&(o=n.delay,n.first&&(n.first=!1,o=10),clearTimeout(t.clearid),t.clearid=setTimeout(function(){l.find("dl > *:not(.".concat(_,")")).remove(),l.find("dd.".concat(N)).addClass(D).text("请求中"),c.ajax(a,e,r,!1,null,!0)},o))):(l.find("dl .".concat(s)).removeClass(s),l.find("dl dd:not(.".concat(_,")")).each(function(t,e){var n=M(e),e=V.filter[a]||P[a].config.filter;e&&1==e(a,r,c.getItem(a,n),n.hasClass(k))&&n.addClass(s)}),l.find("dl dt").each(function(t,e){M(e).nextUntil("dt",":not(.".concat(s,")")).length||M(e).addClass(s)}),this.create(a,i,r),l.find("dl dd:not(.".concat(_,"):not(.").concat(s,")")).length?l.find("dd.".concat(N)).removeClass(D):l.find("dd.".concat(N)).addClass(D).text("无匹配项"))},t.prototype.isArray=function(t){return"[object Array]"==Object.prototype.toString.call(t)},t.prototype.triggerSearch=function(t,a){var c=this;(t?[t]:M(".".concat(E)).toArray()).forEach(function(t,e){var n=(t=M(t)).find("dl").attr("xid");(n&&P[n]&&P[n].config.isEmpty||a)&&c.search(n,null,null,0==P[n].config.searchType?t.find(".".concat(m," .").concat(u)):t.find("dl .".concat(F," .").concat(u)))})},t.prototype.clearInput=function(t){var e=M(".".concat(p,'[fs_id="').concat(t,'"]'));(0==P[t].config.searchType?e.find(".".concat(m," .").concat(u)):e.find("dl .".concat(F," .").concat(u))).val("")},t.prototype.ajax=function(n,a,c,o,i,r,l,s){var d,t,f=this,u=M(".".concat(p,' dl[xid="').concat(n,'"]')).parents(".".concat(E));u[0]&&a&&(d=J[n]||U,(t=M.extend(!0,{},d.data))[d.searchName]=c,M.ajax({type:d.type,headers:d.header,url:a,data:"json"==d.dataType?JSON.stringify(t):t,success:function(t){var e;"string"==typeof t&&(t=JSON.parse(t)),d.beforeSuccess&&d.beforeSuccess instanceof Function&&(t=d.beforeSuccess(n,a,c,t)),f.isArray(t)&&((e={})[d.response.statusName]=d.response.statusCode,e[d.response.msgName]="",e[d.response.dataName]=t,t=e),t[d.response.statusName]!=d.response.statusCode?u.find("dd.".concat(N)).addClass(D).text(t[d.response.msgName]):(u.find("dd.".concat(N)).removeClass(D),f.renderData(n,t[d.response.dataName],o,i,r,s),P[n].config.isEmpty=0==t[d.response.dataName].length),l&&l(n),d.success&&d.success instanceof Function&&d.success(n,a,c,t)},error:function(t){u.find("dd[lay-value]:not(.".concat(_,")")).remove(),u.find("dd.".concat(N)).addClass(D).text("服务异常"),d.error&&d.error instanceof Function&&d.error(n,a,c,t)}}))},t.prototype.renderData=function(n,t,e,a,c,o){var i,r,l,s,d,f=this;e?this.renderLinkage(n,t,a):o?this.renderReplace(n,t):(a=M(".".concat(p,' dl[xid="').concat(n,'"]')).parents(".".concat(E)),i=J[n]||U,o=a.find(".".concat(h," input")),t=this.exchangeData(n,t),r=[],a.find("dl").html(this.renderSelect(n,o.attr("placeholder")||o.attr("back"),t.map(function(t){t=M.extend({},t,{innerHTML:t[i.keyName],value:t[i.keyVal],sel:t[i.keySel],disabled:t[i.keyDis],type:t.type,name:t[i.keyName]});return t.sel&&r.push(t),t}))),l=a.find(".".concat(m)),s=a.find("dl[xid]"),c?((d=P[n].values).forEach(function(t,e){s.find('dd[lay-value="'.concat(t.value,'"]')).addClass(v)}),r.forEach(function(t,e){-1==f.indexOf(d,t)&&(f.addLabel(n,l,t),s.find('dd[lay-value="'.concat(t.value,'"]')).addClass(v),d.push(t))})):(r.forEach(function(t,e){f.addLabel(n,l,t),s.find('dd[lay-value="'.concat(t.value,'"]')).addClass(v)}),P[n].values=r),this.commonHandler(n,l))},t.prototype.renderLinkage=function(o,t,a){var e=[],n=0,i={0:t},r=J[o]||U;R[o]={};for(;function(){var c=e[n++]=[],t=i;i={},M.each(t,function(a,t){M.each(t,function(t,e){var n={pid:a,name:e[r.keyName],value:e[r.keyVal]};R[o][n.value]=M.extend(e,n),c.push(n);e=e[r.keyChildren];e&&e.length&&(i[n.value]=e)})})}(),Object.getOwnPropertyNames(i).length;);var t=M(".".concat(p,' dl[xid="').concat(o,'"]')).parents(".".concat(E)),c=['<div class="xm-select-linkage">'];M.each(e,function(t,e){var n=['<div style="left: '.concat(+a*t,'px;" class="xm-select-linkage-group xm-select-linkage-group').concat(t+1," ").concat(0!=t?"xm-select-linkage-hide":"",'">')];M.each(e,function(t,e){e='<li title="'.concat(e.name,'" pid="').concat(e.pid,'" xm-value="').concat(e.value,'"><span>').concat(e.name,"</span></li>");n.push(e)}),n.push("</div>"),c=c.concat(n)}),c.push('<div style="clear: both; height: 288px;"></div>'),c.push("</div>"),t.find("dl").html(c.join("")),t.find(".".concat(u)).css("display","none")},t.prototype.renderReplace=function(e,t){var n=this,a=M(".".concat(p,' dl[xid="').concat(e,'"]')),c=J[e]||U;t=this.exchangeData(e,t);t=(R[e]=t).map(function(t){t=M.extend({},t,{innerHTML:t[c.keyName],value:t[c.keyVal],sel:t[c.keySel],disabled:t[c.keyDis],type:t.type,name:t[c.keyName]});return n.createDD(e,t)}).join("");a.find("dd:not(.".concat(_,"),dt:not([style])")).remove(),a.find("dt[style]").after(M(t))},t.prototype.exchangeData=function(t,e){var n=J[t]||U,a=n.keyChildren,n=n.keyDis;return R[t]={},this.getChildrenList(e,a,n,[],!1)},t.prototype.getChildrenList=function(t,e,n,a,c){for(var o=[],i=0,r=0;r<t.length;r++){var l,s,d=t[r];d.type&&"optgroup"==d.type?o.push(d):(i++,(s=a.concat([])).push("".concat(i-1,"_E")),d[O]=JSON.stringify(s),d[n]=d[n]||c,o.push(d),(l=d[e])&&W.isArray(l)&&l.length&&(d.XM_TREE_FOLDER=!0,s=s.concat([]),d=this.getChildrenList(l,e,n,s,d[n]),o=o.concat(d)))}return o},t.prototype.create=function(t,e,n){var a,c,o,i;e&&n?(i=P[t],c=(a=M('[xid="'.concat(t,'"]'))).find("dd.".concat(_,".").concat(F)),o=null,e=a.find("dd.".concat(C)),a.find("dd:not(.".concat(_,"):not(.").concat(C,")")).each(function(t,e){n==M(e).find("span").attr("name")&&(o=e)}),o||(i=i.config.create(t,n),e[0]?(e.attr("lay-value",i),e.find("span").text(n),e.find("span").attr("name",n),e.removeClass(s)):c.after(M(this.createDD(t,{name:n,innerHTML:n,value:i},"".concat(C," ").concat("xm-select-create-long")))))):M("[xid=".concat(t,"] dd.").concat(C)).remove()},t.prototype.createDD=function(t,e,n){var a=J[t]||U,c=M.trim(e.innerHTML);R[t][e.value]=M(e).is("option")?((o={})[a.keyName]=c,o[a.keyVal]=e.value,o[a.keyDis]=e.disabled,e=o):e;var a=P[t].config.template(t,e),o=e[O],t=-1==(o=o?JSON.parse(o):[-1])[0]?"":'tree-id="'.concat(o.join("-"),'" tree-folder="').concat(!!e.XM_TREE_FOLDER,'"');return'<dd lay-value="'.concat(e.value,'" class="').concat(e.disabled?k:""," ").concat(n||"",'" ').concat(t,'>\n\t\t\t\t\t<div class="xm-unselect xm-form-checkbox ').concat(e.disabled?k:"",'"  style="margin-left: ').concat(30*(o.length-1),'px">\n\t\t\t\t\t\t<i class="').concat("xm-iconfont",'"></i>\n\t\t\t\t\t\t<span name="').concat(c,'">').concat(a,"</span>\n\t\t\t\t\t</div>\n\t\t\t\t</dd>")},t.prototype.createQuickBtn=function(t,e){return'<div class="'.concat(I,'" method="').concat(t.name,'" title="').concat(t.name,'" ').concat(e?'style="margin-right: '+e+'"':"",'><i class="').concat(t.icon,'"></i><span>').concat(t.name,"</span></div>")},t.prototype.renderBtns=function(t,e,n){var a=this,c=[],o=M('dl[xid="'.concat(t,'"]'));return c.push('<div class="'.concat(i,'" show="').concat(e,'" style="max-width: ').concat(o.prev().width()-54,'px;">')),M.each(P[t].config.btns,function(t,e){c.push(a.createQuickBtn(e,n))}),c.push("</div>"),c.push(this.createQuickBtn({icon:"xm-iconfont icon-caidan",name:""})),c.join("")},t.prototype.renderSelect=function(n,t,e){var a=this;R[n]={};var c=[];return P[n].config.btns.length?(setTimeout(function(){var t=M('dl[xid="'.concat(n,'"]'));t.parents(".".concat(E)).attr(g,P[n].config.searchType),t.find(".".concat(i)).css("max-width","".concat(t.prev().width()-54,"px"))},10),c.push(['<dd lay-value="" class="'.concat(_,'" style="background-color: #FFF!important;">'),this.renderBtns(n,null,"30px"),"</dd>",'<dd lay-value="" class="'.concat(_," ").concat(F,'" style="background-color: #FFF!important;">'),'<i class="xm-iconfont icon-sousuo"></i>','<input type="text" class="'.concat(H," ").concat(u,'" placeholder="请搜索"/>'),"</dd>"].join(""))):c.push('<dd lay-value="" class="'.concat(_,'">').concat(t,"</dd>")),this.isArray(e)?M(e).each(function(t,e){e&&(e.type&&"optgroup"===e.type?c.push("<dt>".concat(e.name,"</dt>")):c.push(a.createDD(n,e)))}):M(e).find("*").each(function(t,e){"option"==e.tagName.toLowerCase()&&0==t&&!e.value||("optgroup"===e.tagName.toLowerCase()?c.push("<dt>".concat(e.label,"</dt>")):c.push(a.createDD(n,e)))}),c.push('<dt style="display:none;"> </dt>'),c.push('<dd class="'.concat(_," ").concat(N," ").concat(2===c.length?D:"",'">没有选项</dd>')),c.join("")},t.prototype.on=function(){var n=this;this.one(),M(document).on("click",function(t){M(t.target).parents(".".concat(A))[0]||(M(".".concat(p," dl .").concat(s)).removeClass(s),M(".".concat(p," dl dd.").concat(D)).removeClass(D),M(".".concat(p," dl dd.").concat(C)).remove(),M.each(P,function(t,e){n.clearInput(t),e.values.length||n.changePlaceHolder(M('div[FS_ID="'.concat(t,'"] .').concat(m)))})),M(".".concat(p," .").concat(l)).each(function(t,e){n.changeShow(M(e).find(".".concat(A)),!1)})})},t.prototype.calcLabelLeft=function(t,e,n){var a=this.getPosition(t[0]);a.y=a.x+t[0].clientWidth;var c,o=t[0].offsetLeft;t.find("span").length?n?(n=("none"==(n=t.find("span:last")).css("display")?n.prev():n)[0],(c=this.getPosition(n)).y=c.x+n.clientWidth,o=c.y>a.y?o-(c.y-a.y)-5:0):e<0?(c=("none"==(c=t.find(":last")).css("display")?c.prev():c)[0],(e=this.getPosition(c)).y=e.x+c.clientWidth,e.y>a.y&&(o-=10)):(o<0&&(o+=10),0<o&&(o=0)):o=0,t.css("left",o+"px")},t.prototype.one=function(t){var m=this;M(t||document).off("click",".".concat(A)).on("click",".".concat(A),function(t){var e=M(t.target),n=e.is(A)?e:e.parents(".".concat(A)),a=n.next(),c=a.attr("xid");if(M("dl[xid]").not(a).each(function(t,e){m.clearInput(M(e).attr("xid"))}),M("dl[xid]").not(a).find("dd.".concat(s)).removeClass(s),n.hasClass(b))return!1;if(e.is(".".concat(j))||e.is(".".concat(u,"[readonly]")))return m.changeShow(n,!n.parents(".".concat(E)).hasClass(l)),!1;if(n.find(".".concat(u,":not(readonly)"))[0]){var o=n.find(".".concat(u)),i={x:t.pageX,y:t.pageY},r=m.getPosition(n[0]);for(n.width();i.x>r.x;){if(M(document.elementFromPoint(i.x,i.y)).is(o))return o.focus(),m.changeShow(n,!0),!1;i.x-=50}}if(e.is(".".concat(u)))return m.changeShow(n,!0),!1;if(e.is('i[fsw="'.concat(f,'"]'))){e=m.getItem(c,e),a=a.find("dd[lay-value='".concat(e.value,"']"));return a.hasClass(k)?!1:(m.handlerLabel(c,a,!1,e),!1)}return m.changeShow(n,!n.parents(".".concat(E)).hasClass(l)),!1}),M(t||document).off("click","dl.".concat(T)).on("click","dl.".concat(T),function(t){if((e=M(t.target)).is(".".concat(S))||e.parents(".".concat(S))[0]){var e,n=(e=e.is("li")?e:e.parents("li[xm-value]")).parents(".xm-select-linkage-group"),t=e.parents("dl").attr("xid");if(!t)return!1;n.find(".xm-select-active").removeClass("xm-select-active"),e.addClass("xm-select-active"),n.nextAll(".xm-select-linkage-group").addClass("xm-select-linkage-hide");n=n.next(".xm-select-linkage-group");if(n.find("li").addClass("xm-select-linkage-hide"),n.find('li[pid="'.concat(e.attr("xm-value"),'"]')).removeClass("xm-select-linkage-hide"),n[0]&&0!=n.find("li:not(.xm-select-linkage-hide)").length)n.removeClass("xm-select-linkage-hide");else{var a=[],c=0,o=!e.hasClass("xm-select-this");for(P[t].config.radio&&e.parents(".xm-select-linkage").find(".xm-select-this").removeClass("xm-select-this");a[c++]={name:e.find("span").text(),value:e.attr("xm-value")},e=e.parents(".xm-select-linkage-group").prev().find('li[xm-value="'.concat(e.attr("pid"),'"]')),e.length;);a.reverse();var i={name:a.map(function(t){return t.name}).join("/"),value:a.map(function(t){return t.value}).join("/")};m.handlerLabel(t,null,o,i)}return!1}if(e.is("dl"))return!1;if(e.is("dt"))return e.nextUntil("dt").each(function(t,e){(e=M(e)).hasClass(k)||e.hasClass(v)||e.find("i:not(.icon-expand)").click()}),!1;var r=e.is("dd")?e:e.parents("dd"),l=r.parent("dl").attr("xid");if(r.hasClass(k))return!1;if(e.is("i.icon-caidan")){var s=[],d=[];return e.parents("dl").find('dd[tree-folder="true"]').each(function(t,e){(null==M(e).attr("xm-tree-hidn")?s:d).push(e)}),(d.length?d:s).forEach(function(t){return t.click()}),!1}var f=r.attr("tree-id");if(f){if(e.is("i:not(.icon-expand)"))return m.handlerLabel(l,r,!r.hasClass(v)),!1;var u=J[l]||U,p=u.tree,o=r.nextAll('dd[tree-id^="'.concat(f,'"]'));if(o&&o.length){i=o[0].clientHeight;return i?(m.addTreeHeight(r,i),i=0):(i=r.attr("xm-tree-hidn")||36,r.removeAttr("xm-tree-hidn"),r.find(">i").remove(),o=o.filter(function(t,e){return M(e).attr("tree-id").split("-").length-1==f.split("-").length})),o.animate({height:i},150),!1}if(p.nextClick&&p.nextClick instanceof Function)return p.nextClick(l,m.getItem(l,r),function(t){var n;t&&t.length?(r.attr("tree-folder","true"),n=[],t.forEach(function(t,e){t.innerHTML=t[u.keyName],t[O]=JSON.stringify(f.split("-").concat([e])),n.push(m.createDD(l,t)),R[l][t[u.keyVal]]=t}),r.after(n.join(""))):m.handlerLabel(l,r,!r.hasClass(v))}),!1}if(r.hasClass(_)){p=e.is(".".concat(I))?e:e.parents(".".concat(I));if(!p[0])return!1;var h=p.attr("method"),p=P[l].config.btns.filter(function(t){return t.name==h})[0];return p&&p.click&&p.click instanceof Function&&p.click(l,m),!1}return m.handlerLabel(l,r,!r.hasClass(v)),!1})},t.prototype.addTreeHeight=function(t,n){var a=this,e=t.attr("tree-id"),e=t.nextAll('dd[tree-id^="'.concat(e,'"]'));e.length&&(t.append('<i class="xm-iconfont icon-expand"></i>'),t.attr("xm-tree-hidn",n),e.each(function(t,e){e=M(e);a.addTreeHeight(e,n)}))};var R={};t.prototype.getItem=function(t,e){if(e instanceof M){if(e.is('i[fsw="'.concat(f,'"]'))){var n=e.parent();return R[t][e]||{name:n.find("font").text(),value:n.attr("value")}}n=e.attr("lay-value");return R[t][n]||(R[t][n]={name:e.find("span[name]").attr("name"),value:n})}return"string"==typeof e&&-1!=e.indexOf("/")?R[t][e]||{name:this.valToName(t,e),value:e}:R[t][e]},t.prototype.linkageAdd=function(t,e){var n=M('dl[xid="'.concat(t,'"]'));n.find(".xm-select-active").removeClass("xm-select-active");for(var a,c,o=e.value.split("/"),i=0,r=[];a=o[i],(c=n.find(".xm-select-linkage-group".concat(i+1,' li[xm-value="').concat(a,'"]')))[0]&&r.push(c),i++,c.length&&null!=a;);r.length==o.length&&M.each(r,function(t,e){e.addClass("xm-select-this")})},t.prototype.linkageDel=function(t,e){for(var n,a,c=M('dl[xid="'.concat(t,'"]')),o=e.value.split("/"),i=o.length-1;n=o[i],(a=c.find(".xm-select-linkage-group".concat(i+1,' li[xm-value="').concat(n,'"]'))).parent().next().find("li[pid=".concat(n,"].xm-select-this")).length||a.removeClass("xm-select-this"),i--,a.length&&null!=n;);},t.prototype.valToName=function(t,e){var n=M('dl[xid="'.concat(t,'"]')),e=(e+"").split("/");if(!e.length)return null;var a=[];return M.each(e,function(t,e){e=n.find(".xm-select-linkage-group".concat(t+1,' li[xm-value="').concat(e,'"] span')).text();a.push(e)}),a.length==e.length?a.join("/"):null},t.prototype.commonHandler=function(t,e){e&&e[0]&&(this.checkHideSpan(t,e),this.changePlaceHolder(e),this.retop(e.parents(".".concat(E))),this.calcLabelLeft(e,0,!0),this.setHidnVal(t,e),e.parents(".".concat(A," .").concat(f)).attr("title",P[t].values.map(function(t){return t.name}).join(",")))},t.prototype.initVal=function(t){var i=this,e={};t?e[t]=P[t]:e=P,M.each(e,function(n,t){var e=t.values,a=M('dl[xid="'.concat(n,'"]')).parent(),c=a.find(".".concat(m)),o=a.find("dl");o.find("dd.".concat(v)).removeClass(v);a=e.concat([]);a.concat([]).forEach(function(t,e){i.addLabel(n,c,t),o.find('dd[lay-value="'.concat(t.value,'"]')).addClass(v)}),t.config.radio&&a.length&&e.push(a[a.length-1]),i.commonHandler(n,c)})},t.prototype.setHidnVal=function(t,e){e&&e[0]&&e.parents(".".concat(p)).find(".".concat(L)).val(P[t].values.map(function(t){return t.value}).join(","))},t.prototype.handlerLabel=function(t,e,n,a,c){var o=M('[xid="'.concat(t,'"]')).prev().find(".".concat(m)),i=e&&this.getItem(t,e),r=P[t].values,l=P[t].config.on||V.on[t],s=P[t].config.endOn||V.endOn[t];a&&(i=a);var d=P[t];n&&d.config.max&&d.values.length>=d.config.max?(a=V.maxTips[t]||P[t].config.maxTips)&&a(t,r.concat([]),i,d.config.max):!c&&l&&l instanceof Function&&0==l(t,r.concat([]),i,n,e&&e.hasClass(k))||(l=M('dl[xid="'.concat(t,'"]')),n?(e&&e[0]?(e.addClass(v),e.removeClass(C)):l.find(".xm-select-linkage")[0]&&this.linkageAdd(t,i),this.addLabel(t,o,i),r.push(i)):(e&&e[0]?e.removeClass(v):l.find(".xm-select-linkage")[0]&&this.linkageDel(t,i),this.delLabel(t,o,i),this.remove(r,i)),o[0]&&(d.config.radio&&this.changeShow(o,!1),o.parents(".".concat(A)).prev().removeClass("layui-form-danger"),d.config.clearInput&&this.clearInput(t),this.commonHandler(t,o),!c&&s&&s instanceof Function&&s(t,r.concat([]),i,n,e&&e.hasClass(k))))},t.prototype.addLabel=function(t,e,n){var a,c;n&&(c='fsw="'.concat(f,'"'),c=(a=[M("<span ".concat(c,' value="').concat(n.value,'"><font ').concat(c,">").concat(n.name,"</font></span>")),M("<i ".concat(c,' class="xm-iconfont icon-close"></i>'))])[1],(a=a[0]).append(c),(c=P[t]).config.radio&&(c.values.length=0,M('dl[xid="'.concat(t,'"]')).find("dd.".concat(v,':not([lay-value="').concat(n.value,'"])')).removeClass(v),e.find("span").remove()),e.find("input").css("width","50px"),e.find("input").before(a))},t.prototype.delLabel=function(t,e,n){n&&e.find('span[value="'.concat(n.value,'"]:first')).remove()},t.prototype.checkHideSpan=function(t,e){e.parents(".".concat(f))[0].offsetHeight;e.find("span.xm-span-hide").removeClass("xm-span-hide"),e.find("span[style]").remove();var n=P[t].config.showCount;e.find("span").each(function(t,e){n<=t&&M(e).addClass("xm-span-hide")});t=e.find("span:eq(".concat(n,")"));t[0]&&t.before(M('<span style="padding-right: 6px;" fsw="'.concat(f,'"> + ').concat(e.find("span").length-n,"</span>")))},t.prototype.retop=function(t){var e=t.find("dl"),n=t.offset().top+t.outerHeight()+5-o.scrollTop(),a=e.outerHeight(),c=t.hasClass("layui-form-selectup")||-1!=e.css("top").indexOf("-")||n+a>o.height()&&a<=n;t=t.find(".".concat(f));a=P[e.attr("xid")],n=e.parents(".layui-form-pane")[0]&&38<e.prev()[0].clientHeight?14:10;(a&&"up"==a.config.direction||c)&&(c=!0,a&&"down"==a.config.direction&&(c=!1));n=t[0].offsetTop+t.height()+n;c?e.css({top:"auto",bottom:n+3+"px"}):e.css({top:n+"px",bottom:"auto"})},t.prototype.changeShow=function(t,e){M(".layui-form-selected").removeClass("layui-form-selected");var n=t.parents(".".concat(E)),a=n.hasClass(l),t=n.find("dl").attr("xid");M(".".concat(p," .").concat(E)).not(n).removeClass(l),e?(this.retop(n),n.addClass(l),n.find(".".concat(u)).focus(),n.find("dl dd[lay-value]:not(.".concat(_,")")).length||n.find("dl .".concat(N)).addClass(D)):(n.removeClass(l),this.clearInput(t),n.find("dl .".concat(D)).removeClass(D),n.find("dl dd.".concat(s)).removeClass(s),n.find("dl dd.".concat(C)).remove(),t&&P[t]&&P[t].config.isEmpty&&this.triggerSearch(n),this.changePlaceHolder(n.find(".".concat(m)))),e!=a&&(a=P[t].config.opened||V.opened[t],e&&a&&a instanceof Function&&a(t),a=P[t].config.closed||V.closed[t],!e&&a&&a instanceof Function&&a(t))},t.prototype.changePlaceHolder=function(t){var e,n,a,c=t.parents(".".concat(A));(c=!c[0]?t.parents("dl").prev():c)[0]&&(e=t.parents(".".concat(p)).find("dl[xid]").attr("xid"),P[e]&&P[e].config.height||(n=c.find(".".concat(f))[0].clientHeight,c.css("height",(36<n?n+4:n)+"px"),(e=c.parents(".".concat(p)).parent().prev()).is(".layui-form-label")&&c.parents(".layui-form-pane")[0]&&(n=36<n?n+4:n,c.css("height",n+"px"),e.css({height:n+2+"px",lineHeight:n-18+"px"}))),n=c.find(".".concat(h," input")),!t.find("span:last")[0]&&!c.find(".".concat(u)).val()?(a=n.attr("back"),n.removeAttr("back"),n.attr("placeholder",a)):(a=n.attr("placeholder"),n.removeAttr("placeholder"),n.attr("back",a)))},t.prototype.indexOf=function(t,e){for(var n=0;n<t.length;n++)if(t[n].value==e||t[n].value==(e&&e.value)||t[n]==e||JSON.stringify(t[n])==JSON.stringify(e))return n;return-1},t.prototype.remove=function(t,e){e=this.indexOf(t,e&&e.value);return-1<e&&(t.splice(e,1),!0)},t.prototype.selectAll=function(n,a,t){var c=this,o=M('[xid="'.concat(n,'"]'));o[0]&&(o.find(".xm-select-linkage")[0]||o.find("dd[lay-value]:not(.".concat(_,"):not(.").concat(v,")").concat(t?":not(."+k+")":"")).each(function(t,e){e=M(e);e=c.getItem(n,e);c.handlerLabel(n,o.find('dd[lay-value="'.concat(e.value,'"]')),!0,e,!a)}))},t.prototype.removeAll=function(n,a,c){var o=this,i=M('[xid="'.concat(n,'"]'));i[0]&&(i.find(".xm-select-linkage")[0]?P[n].values.concat([]).forEach(function(t,e){for(var n,a,c=t.value.split("/"),o=0;n=c[o++],(a=i.find(".xm-select-linkage-group".concat(o,':not(.xm-select-linkage-hide) li[xm-value="').concat(n,'"]'))).click(),a.length&&null!=n;);}):P[n].values.concat([]).forEach(function(t,e){c&&i.find('dd[lay-value="'.concat(t.value,'"]')).hasClass(k)||o.handlerLabel(n,i.find('dd[lay-value="'.concat(t.value,'"]')),!1,t,!a)}))},t.prototype.reverse=function(a,c,t){var o=this,i=M('[xid="'.concat(a,'"]'));i[0]&&(i.find(".xm-select-linkage")[0]||i.find("dd[lay-value]:not(.".concat(_,")").concat(t?":not(."+k+")":"")).each(function(t,e){e=M(e);var n=o.getItem(a,e);o.handlerLabel(a,i.find('dd[lay-value="'.concat(n.value,'"]')),!e.hasClass(v),n,!c)}))},t.prototype.skin=function(t){var e=["default","primary","normal","warm","danger"],e=e[Math.floor(Math.random()*e.length)];M('dl[xid="'.concat(t,'"]')).parents(".".concat(p)).find(".".concat(E)).attr("xm-select-skin",e),this.check(t)&&this.commonHandler(t,M('dl[xid="'.concat(t,'"]')).parents(".".concat(p)).find(".".concat(m)))},t.prototype.getPosition=function(t){for(var e=0,n=0;null!=t;)e+=t.offsetLeft,n+=t.offsetTop,t=t.offsetParent;return{x:e,y:n}},t.prototype.onreset=function(){M(document).on("click","[type=reset]",function(t){M(t.target).parents("form").find(".".concat(p," dl[xid]")).each(function(t,e){var n,a=e.getAttribute("xid"),c=M(e),o={};W.removeAll(a),P[a].config.init.forEach(function(t,e){t&&(!o[t]||P[a].config.repeat)&&(n=c.find('dd[lay-value="'.concat(t.value,'"]')))[0]&&(W.handlerLabel(a,n,!0),o[t]=1)})})})},t.prototype.bindEvent=function(n,t,a){t&&t instanceof Function&&(a=t,t=null),a&&a instanceof Function&&(t?P[t]?(P[t].config[n]=a,delete V[n][t]):V[n][t]=a:M.each(P,function(t,e){P[t]?P[t].config[n]=a:V[n][t]=a}))},t.prototype.check=function(t,e){return!!M('dl[xid="'.concat(t,'"]')).length||(M('select[xm-select="'.concat(t,'"]')).length?e?void 0:(this.render(t,M('select[xm-select="'.concat(t,'"]'))),!0):(delete P[t],!1))},t.prototype.render=function(t,e){W.init(e),W.one(M('dl[xid="'.concat(t,'"]')).parents(".".concat(p))),W.initVal(t)},t.prototype.log=function(t){};function r(){this.v="4.0.0.0910",this.render()}var W=new t;return r.prototype.value=function(n,t,e){if("string"!=typeof n)return[];var a,c,o,i,r=P[n];if(!W.check(n))return[];if("string"==typeof t||null==t){var l=r.values.concat([])||[];return"val"==t?l.map(function(t){return t.value}):"valStr"==t?l.map(function(t){return t.value}).join(","):"name"==t?l.map(function(t){return t.name}):"nameStr"==t?l.map(function(t){return t.name}).join(","):l}W.isArray(t)&&(a=M('[xid="'.concat(n,'"]')),c={},i=!0,0==e?i=!1:1==e?i=!0:W.removeAll(n),i&&r.values.forEach(function(t,e){c[t.value]=1}),t.forEach(function(t,e){!t||c[t]&&!r.config.repeat||((o=a.find('dd[lay-value="'.concat(t,'"]')))[0]?(W.handlerLabel(n,o,i,null,!0),c[t]=1):W.valToName(n,t)&&(W.handlerLabel(n,o,i,W.getItem(n,t),!0),c[t]=1))}))},r.prototype.on=function(t,e,n){return W.bindEvent(n?"endOn":"on",t,e),this},r.prototype.filter=function(t,e){return W.bindEvent("filter",t,e),this},r.prototype.maxTips=function(t,e){return W.bindEvent("maxTips",t,e),this},r.prototype.opened=function(t,e){return W.bindEvent("opened",t,e),this},r.prototype.closed=function(t,e){return W.bindEvent("closed",t,e),this},r.prototype.config=function(t,n,e){return t&&"object"==_typeof(t)&&(e=1==n,n=t,t=null),n&&"object"==_typeof(n)&&(e&&(n.header||(n.header={}),n.header["Content-Type"]="application/json; charset=UTF-8",n.dataType="json"),t?(J[t]=M.extend(!0,{},J[t]||U,n),W.check(t)||this.render(t),P[t]&&n.direction&&(P[t].config.direction=n.direction),P[t]&&n.clearInput&&(P[t].config.clearInput=!0),n.searchUrl&&P[t]&&W.triggerSearch(M(".".concat(p,' dl[xid="').concat(t,'"]')).parents(".".concat(E)),!0)):(M.extend(!0,U,n),M.each(J,function(t,e){M.extend(!0,e,n)}))),this},r.prototype.render=function(t,e){t&&"object"==_typeof(t)&&(e=t,t=null);var n=e?(_defineProperty(n={init:e.init,disabled:e.disabled,max:e.max,isSearch:e.isSearch,searchUrl:e.searchUrl,isCreate:e.isCreate,radio:e.radio,skin:e.skin,direction:e.direction,height:e.height,formname:e.formname,layverify:e.layverify,layverType:e.layverType,showCount:e.showCount,placeholder:e.placeholder,create:e.create,filter:e.filter,maxTips:e.maxTips,on:e.on},"on",e.on),_defineProperty(n,"opened",e.opened),_defineProperty(n,"closed",e.closed),_defineProperty(n,"template",e.template),_defineProperty(n,"clearInput",e.clearInput),n):{};return e&&null!=e.searchType&&(n.searchType="dl"==e.searchType?1:0),t?(c[t]={},M.extend(c[t],P[t]?P[t].config:{},n)):M.extend(a,n),(M("select[".concat(f,'="').concat(t,'"]'))[0]?M("select[".concat(f,'="').concat(t,'"]')):M("select[".concat(f,"]"))).each(function(t,e){var n=e.getAttribute(f);W.render(n,e),setTimeout(function(){return W.setHidnVal(n,M('select[xm-select="'.concat(n,'"] + div.').concat(p," .").concat(m)))},10)}),this},r.prototype.disabled=function(t){var e={};return t?W.check(t)&&(e[t]=P[t]):e=P,M.each(e,function(t,e){M('dl[xid="'.concat(t,'"]')).prev().addClass(b)}),this},r.prototype.undisabled=function(t){var e={};return t?W.check(t)&&(e[t]=P[t]):e=P,M.each(e,function(t,e){M('dl[xid="'.concat(t,'"]')).prev().removeClass(b)}),this},r.prototype.data=function(t,e,n){return t&&e&&n?W.check(t)?(this.value(t,[]),this.config(t,n),"local"==e?W.renderData(t,n.arr,1==n.linkage,n.linkageWidth||"100"):"server"==e&&W.ajax(t,n.url,n.keyword,1==n.linkage,n.linkageWidth||"100")):W.log("id: ".concat(t," not render !!!")):W.log("id: ".concat(t," param error !!!")),this},r.prototype.btns=function(t,a,c){if(t&&W.isArray(t)&&(a=t,t=null),!a||!W.isArray(a))return this;var e={};return t?W.check(t)&&(e[t]=P[t]):e=P,a=a.map(function(t){if("string"==typeof t){if("select"==t)return n[0];if("remove"==t)return n[1];if("reverse"==t)return n[2];if("skin"==t)return n[3]}return t}),M.each(e,function(t,e){e.config.btns=a;var n,e=M('dl[xid="'.concat(t,'"]')).find(".".concat(_,":first"));a.length?(n=c&&c.show&&("name"==c.show||"Core.Resources.assets.layui.layer.icon"==c.show)?c.show:"",n=W.renderBtns(t,n,c&&c.space?c.space:"30px"),e.html(n)):(n=(n=e.parents(".".concat(E)).find(".".concat(h," input"))).attr("placeholder")||n.attr("back"),e.html(n),e.removeAttr("style"))}),this},r.prototype.search=function(t,e){return t&&W.check(t)&&(J[t]=M.extend(!0,{},J[t]||U,{first:!0,searchVal:e}),W.triggerSearch(M('dl[xid="'.concat(t,'"]')).parents(".".concat(E)),!0)),this},r.prototype.replace=function(t,e,n){var a=this;if(!t||!e||!n)return W.log("id: ".concat(t," param error !!!")),this;if(!W.check(t,!0))return W.log("id: ".concat(t," not render !!!")),this;var c=this.value(t,"val");this.value(t,[]),this.config(t,n),"local"==e?(W.renderData(t,n.arr,1==n.linkage,n.linkageWidth||"100",!1,!0),this.value(t,c,!0)):"server"==e&&W.ajax(t,n.url,n.keyword,1==n.linkage,n.linkageWidth||"100",!1,function(t){a.value(t,c,!0)},!0)},new r});